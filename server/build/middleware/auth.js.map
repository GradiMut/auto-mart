{"version":3,"sources":["../../src/middleware/auth.js"],"names":["jwt","require","verifyToken","req","res","next","checkHeader","headers","authorization","bearer","split","token","verify","err","encoded","status","json","data","exports","modules"],"mappings":";;AAAA;AACA,IAAMA,GAAG,GAAGC,OAAO,CAAC,cAAD,CAAnB;;AAEA,IAAMC,WAAW,GAAG,SAAdA,WAAc,CAACC,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;AACtC,MAAMC,WAAW,GAAGH,GAAG,CAACI,OAAJ,CAAYC,aAAhC;;AAEA,MAAI,OAAOF,WAAP,KAAuB,WAA3B,EAAwC;AACtC,QAAMG,MAAM,GAAGH,WAAW,CAACI,KAAZ,CAAkB,GAAlB,CAAf;AACA,QAAMC,KAAK,GAAGF,MAAM,CAAC,CAAD,CAApB;AACAT,IAAAA,GAAG,CAACY,MAAJ,CAAWD,KAAX,EAAkB,WAAlB,EAA+B,UAACE,GAAD,EAAMC,OAAN,EAAkB;AAC/C,UAAID,GAAJ,EAAS;AACPT,QAAAA,GAAG,CAACW,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AACnBD,UAAAA,MAAM,EAAE,GADW;AAEnBE,UAAAA,IAAI,EAAE;AAFa,SAArB;AAID;;AACDd,MAAAA,GAAG,CAACW,OAAJ,GAAcA,OAAd;AACAT,MAAAA,IAAI;AACL,KATD;AAUD,GAbD,MAaO;AACLD,IAAAA,GAAG,CAACW,MAAJ,CAAW,GAAX,EAAgBC,IAAhB;AACD;AACF,CAnBD;;AAqBAE,OAAO,CAACC,OAAR,GAAkBjB,WAAlB","sourcesContent":["// jshint esversion :6\nconst jwt = require('jsonwebtoken');\n\nconst verifyToken = (req, res, next) => {\n  const checkHeader = req.headers.authorization;\n\n  if (typeof checkHeader !== 'undefined') {\n    const bearer = checkHeader.split(' ');\n    const token = bearer[1];\n    jwt.verify(token, 'secretkey', (err, encoded) => {\n      if (err) {\n        res.status(401).json({\n          status: 401,\n          data: 'Unauthorized access',\n        });\n      }\n      req.encoded = encoded;\n      next();\n    });\n  } else {\n    res.status(403).json();\n  }\n};\n\nexports.modules = verifyToken;\n"],"file":"auth.js"}